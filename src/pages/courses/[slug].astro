---
import Layout from '../../layouts/Layout.astro';
import { courseAdapter } from '../../lib/adapters/course/courseAdapter';
import type { Course } from '../../lib/adapters/course/interface';

export async function getStaticPaths() {
  const courses = await courseAdapter.getAllCourses();
  return courses.map(course => ({
    params: { slug: course.slug },
    props: { course },
  }));
}

interface Props {
  course: Course;
}

const { course } = Astro.props;
---

<Layout title={course.title}>
  <main class="container mx-auto px-4 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <div class="lg:col-span-2">
        <h1 class="text-4xl font-bold mb-2">{course.title}</h1>
        <p class="text-lg text-gray-600 mb-4">Taught by {course.author}</p>

        <div class="prose max-w-none">
          <h2 class="text-2xl font-bold mt-8 mb-4">What you will learn</h2>
          <ul class="list-disc list-inside">
            {course.whatYouWillLearn.map(item => (
              <li>{item}</li>
            ))}
          </ul>

          <h2 class="text-2xl font-bold mt-8 mb-4">What you will build</h2>
          <p>{course.whatYouWillBuild}</p>
        </div>
      </div>
      <div>
        <div class="bg-gray-100 p-6 rounded-lg">
          <img src={course.image} alt={`Cover image for ${course.title}`} class="rounded-lg mb-4" />
          <button class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg w-full">Enroll Now</button>
        </div>
      </div>
    </div>

    <div class="mt-12">
      <h2 class="text-3xl font-bold text-center mb-8">Chapters</h2>
      <div class="space-y-4">
        {course.chapters.map((chapter, index) => (
          <div class="bg-white p-6 rounded-lg shadow">
            <h3 class="text-xl font-bold">
              <span class="text-gray-400 mr-4">{String(index + 1).padStart(2, '0')}</span>
              {chapter.title}
            </h3>
            <p class="text-gray-600 mt-2 ml-10">{chapter.description}</p>
          </div>
        ))}
      </div>
    </div>
  </main>
</Layout>

<style>
  .container {
    max-width: 1000px;
  }
</style>
